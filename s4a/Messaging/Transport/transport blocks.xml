<blocks app="Snap4Arduino 1.2.6
, http://snap4arduino.rocks" version="1"><block-definition s="send serialized message $nl %&apos;serialized message&apos; as command to $robot" type="command" category="arduino"><header></header><code></code><translations></translations><inputs><input type="%txt">&lt;e&gt;(1234)</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>serializedMessage</l></list><l>var array = serializedMessage.split(&apos;&apos;).map(function (char) {&#xD;  return char.charCodeAt(0);&#xD;});&#xD;array.unshift(0x0F);&#xD;this.arduino.board.sysexCommand(array);</l></block><list><block var="serialized message"/></list></block></script></block-definition><block-definition s="whenever %&apos;serialized message&apos; $nl received as response from $robot %&apos;handler&apos;" type="command" category="arduino"><header></header><code></code><translations></translations><inputs><input type="%upvar"></input><input type="%cs"></input></inputs><script><block s="doSetVar"><l>serialized message</l><l>0</l></block><block s="doDeclareVariables"><list><l>serialized message updater</l></list></block><block s="doSetVar"><l>serialized message updater</l><block s="reifyScript"><script><block s="doSetVar"><l>serialized message</l><block var="new serialized message"/></block></script><list><l>new serialized message</l></list></block></block><block s="doRun"><block s="reportJSFunction"><list><l>handler, updater</l></list><l>var arduino = this.arduino;&#xD;arduino.board.onReceivedSerializedMessage = function(serializedMessage) {&#xD;  invoke(updater, new List([serializedMessage]));&#xD;  invoke(handler);&#xD;};&#xD;try {&#xD;  arduino.board.sysexResponse(0x0F, function(data) {&#xD;    var decoded = String.fromCharCode.apply(null, data);&#xD;    arduino.board.onReceivedSerializedMessage(decoded);&#xD;  });&#xD;} catch (error) {&#xD;}</l></block><list><block var="handler"/><block var="serialized message updater"/></list></block></script></block-definition><block-definition s="connect to $robot and run %&apos;valid message handler&apos; whenever %&apos;serialized message&apos; $nl received as response from $robot" type="command" category="arduino"><header></header><code></code><translations></translations><inputs><input type="%cs"></input><input type="%upvar"></input></inputs><script><block s="disconnectArduino"></block><block s="doWaitUntil"><block s="reportNot"><block s="reportConnected"></block></block></block><block s="bubble"><l>Please connect the Arduino...</l></block><block s="doWaitUntil"><block s="reportConnected"></block></block><block s="doSayFor"><l>Arduino connected!</l><l>1</l></block><block s="doDeclareVariables"><list><l>transport connected</l></list></block><block s="doSetVar"><l>transport connected</l><block s="reportBoolean"><l><bool>false</bool></l></block></block><custom-block s="whenever %upvar %br received as response from $robot %cs"><l>message</l><script><block s="doIfElse"><block s="reportEquals"><block var="message"/><l>&#126;</l></block><script><custom-block s="send serialized message %br %txt as command to $robot"><l></l></custom-block></script><script><block s="doIfElse"><block s="reportEquals"><block s="reportStringSize"><block var="message"/></block><l>0</l></block><script><block s="doSetVar"><l>transport connected</l><block s="reportBoolean"><l><bool>true</bool></l></block></block></script><script><block s="doIf"><block var="transport connected"/><script><block s="doSetVar"><l>serialized message</l><block var="message"/></block><block s="doRun"><block var="valid message handler"/><list></list></block></script></block></script></block></script></block></script></custom-block><block s="doWaitUntil"><block var="transport connected"/></block></script></block-definition></blocks>